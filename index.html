<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel = "stylesheet" href = "assets/css/reset.css">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css">
    
    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="https://getbootstrap.com/docs/3.3/examples/sticky-footer-navbar/sticky-footer-navbar.css" >
   
    <link rel = "stylesheet" href = "assets/css/style.css">

    <title>Hangman Game</title>

</head>

<body>

    <header>
        <nav class = "navbar navbar-default">
            <div class = "container">
                <a class = "navbar-brand">
                    Let's Play The Hangman Game!
                </a>
            </div>
        </nav>
    </header>

    <section class="container">

        <div class="row">
            <div class="col-md-12 text-uppercase" id = "hiddenDisplay">
                <p>BEST LUCK!</p>
            </div>
        </div>

        <div class="row gameenable">

            <div class="col-md-6">
                <p class = "headingselector text-uppercase">choose basic or challenging</p>
                <div class="row">
                    <div class="col-md-offset-3 col-md-3">
                        <button type="button" class="btn btn-primary text-uppercase" onclick="basic()" id = "basicBtn">BASIC</button>
                    </div>
                    <div class="col-md-3">
                        <button type="button" class="btn btn-primary text-uppercase" onclick="challenge()" id = "challengeBtn">CHALLENGING</button>
                    </div>
                </div>
            </div>

            <div class="col-md-5">
                <p class = "headingselector text-uppercase ">START, STOP and RESET GAME</p>
                <div class="row">
                    <div class="col-md-offset-2 col-md-3">
                        <button type="submit" class="btn btn-success text-uppercase" onclick="startGame()" id = "startBtn">START</button>
                    </div>
                    <div class="col-md-3">
                        <button type="submit" class="btn btn-danger text-uppercase" onclick="stopGame()" id = "stopBtn">STOP</button>
                    </div>
                    <div class="col-md-3">
                        <button type="reset" class="btn btn-warning text-uppercase" onclick="restartGame()" id = "restartBtn">restart</button>
                    </div>
                </div>
            </div>

        </div>

        <div class="row linebreak"></div>

        <div class="row">
            <div class="col-md-12">
                <p class="text-center gameWordDisplay" >GAME ROUND #  <span id = "numberofround">0</span></p>
            </div>
            <div class="row resultDisplay">
                    <div class="col-md-offset-2 col-md-3">
                        <p class="text-center winNumDisplay"><u>You Won #  <span id = "numberofwin">0</span></u></p>
                    </div>
                    <div class="col-md-3">
                        <p class="text-center winNumDisplay" ><u>You Lost #  <span id = "numberoflose">0</span></u></p>
                    </div>
                    <div class="col-md-3">
                        <button type = "submit" class="btn btn-primary text-uppercase" onclick="continueGame()" id = "continueBtn">continue</button>
                    </div>
            </div>
            <div class="row">
                <div class="col-md-1 letterstyle text-uppercase" id = "letter_0"></div>
                <div class="col-md-1 letterstyle text-uppercase" id = "letter_1"></div>
                <div class="col-md-1 letterstyle text-uppercase" id = "letter_2"></div>
                <div class="col-md-1 letterstyle text-uppercase" id = "letter_3"></div>
                <div class="col-md-1 letterstyle text-uppercase" id = "letter_4"></div>
                <div class="col-md-1 letterstyle text-uppercase" id = "letter_5"></div>
                <div class="col-md-1 letterstyle text-uppercase" id = "letter_6"></div>
                <div class="col-md-1 letterstyle text-uppercase" id = "letter_7"></div>
                <div class="col-md-1 letterstyle text-uppercase" id = "letter_8"></div>
                <div class="col-md-1 letterstyle text-uppercase" id = "letter_9"></div>
                <div class="col-md-1 letterstyle text-uppercase" id = "letter_10"></div>
                <div class="col-md-1 letterstyle text-uppercase" id = "letter_11"></div>
            </div>
        </div>

        <div class="row linebreak"></div>

        <div class="row">
            <div class="col-md-12">
                <div class="text-center resultarea" ><span id = "resultText"></span></div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <span id = "img_id"><img class = "imgDisplay"  src = "assets/images/hangman.jpg"></span>
            </div>

            <div class="col-md-6">

                <div class="row linebreak"></div>
                <div class="row linebreak"></div>
                <div class="row linebreak"></div>

                <div class="row btnrowbreak"></div>
                <div class="row">
                        <button id ="q" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">q</button>
                        <button id ="w" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">w</button>
                        <button id ="e" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">e</button>
                        <button id ="r" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">r</button>
                        <button id ="t" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">t</button>
                        <button id ="y" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">y</button>
                        <button id ="u" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">u</button>
                        <button id ="i" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">i</button>
                        <button id ="o" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">o</button>
                        <button id ="p" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">p</button>
                </div>

                <div class="row btnrowbreak"></div>
                <div class="row">
                        <button id ="a" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">a</button>
                        <button id ="s" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">s</button>
                        <button id ="d" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">d</button>
                        <button id ="f" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">f</button>
                        <button id ="g" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">g</button>
                        <button id ="h" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">h</button>
                        <button id ="j" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">j</button>
                        <button id ="k" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">k</button>
                        <button id ="l" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">l</button>
                </div>

                <div class="row btnrowbreak"></div>
                <div class="row">
                        <button id ="z" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">z</button>
                        <button id ="x" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">x</button>
                        <button id ="c" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">c</button>
                        <button id ="v" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">v</button>
                        <button id ="b" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">b</button>
                        <button id ="n" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">n</button>
                        <button id ="m" type="button kBDisable" class="btn btn-info btn-lg btnLetter text-uppercase" onclick="btnfunction(this.id)">m</button>
                </div>
            </div>
        </div>

    <div class="row linebreak"></div>
    <div class="row linebreak"></div>
    <div class="row linebreak"></div>

    </section>

    <footer class="footer">
        <div class = "container">
            <p class="text-muted" style = "text-align: center;">&copy Copyright 2018 Eric Jia</p>
        </div>
    </footer>

    <script type="text/javascript" charset="UTF-8" scr = "assets/javascript/game.js" >

// Basic words pool
var word_basic = ['tree', 'boat', 'human', 'baby', 'moon'];
// var word_basic = ['tree', 'moon'];

//challenging words pool
var word_challenge = ['fortlee','darkknight','mitsubishi','metuchen','philadelphia'];
// var word_challenge = ['fortlee','metuchen'];

//selection of words which will be used once Player start the game
var word_pool = [];

// Game enabled
var gameon = false;
var gamependingkey = false;

// Basic or Challenging mode selected. 
var levelSelected = false;

var resultDisplay = document.getElementById("hiddenDisplay");

// Show what's current game round once Start or Restart the Game. 
var roundDisplay = document.getElementById("numberofround");
var gameround = 0;

// Display image according to current action, wrong guess or successful guess overall. 
var currentImg = document.getElementById("img_id");

// Display how may successful guess Play has win or lose
var guessSuccessDisplay = document.getElementById("numberofwin");
var guessFailedDisplay = document.getElementById("numberoflose");

// This game can display up to 12 letters, words needs to be less or equal to 12 letters. 
var letterIdList = ["letter_0","letter_1","letter_2","letter_3","letter_4","letter_5","letter_6","letter_7","letter_8","letter_9","letter_10","letter_11"];

// Player needs to pick Basic or Standard level frist before start the Game, otherwise display this alert message. 
var notChooseHtml = "<p>choose basic or challenging first</p>";
var notChooseHtml_2 = "<p>Choose basic or challenging first and then hit START"

// Fail message and ask try again
var failHtml = "<p>mission failed, click Continue totry again!</p>"

// Guess correct notice 
var successNote = "<p>Yes, You made it</p>"

// Disable notice display, nothing need to be alerted 
var nullHtml = "<p></p>";

//Guess all the word, Game ends
var guessCompleteHtml = "<p>Well done and Congrats! Click Restart to replay....</p>"

// How many guess can be made before fail
var guessleft = 0;

// Number of words Player guess successfully
var guessSuccess = 0;

// Number of words Player guess unsuccessfully
var guessFailed = 0;

// the length of the word that is currently being guessed by Player. 
var correctNumLetter = 0;

// Current word guess boolean, true if guess right, false if fail to guess after 6 steps. 
var currentWordGuess = false;

// the counts of specific letters for one specific word, e.g. count of 2 for letter of "e" in word of "tree"
var letternum = 0;

// once word_pool is identified or updated, use getRandomInt(num) to pick the word left in the word_pool and assign it to wordOfGame
var wordOfGame = "";
var wordofGameName = "";

// once wordOfGame is identified, create a array to store all the letters of the wordOfGame in letterOfWord. 
var letterOfWord = [];

// Create index of the image for hangman progress step and it can also indicate how many guess left.
var imageIndex = 0;

// Key activiated list
var keyActived = [];

// Hangman progress image list
var hangmanimglist = ["assets/images/Step_0.png","assets/images/Step_1.png","assets/images/Step_2.png","assets/images/Step_3.png","assets/images/Step_4.png","assets/images/Step_5.png","assets/images/Step_6.jpeg"];

// Words image dict
var wordImgList = {
    "tree" : "assets/images/tree.jpg",
    "boat" : "assets/images/boat.jpg",
    "human" : "assets/images/human.jpg",
    "baby" : "assets/images/baby.jpg",
    "moon" : "assets/images/moon.jpg",
    "fortlee" : "assets/images/fortlee.jpg",
    "darkknight" : "assets/images/darkknight.jpg",
    "mitsubishi" : "assets/images/mitsubishi.png",
    "metuchen" : "assets/images/metuchen.jpg",
    "philadelphia" :"assets/images/philadelphia.jpg",
};

// Create word class to get length, letters of the word. 
class word {
    constructor(name) {
        this.name = name;
    }

    get wordlen() {
        return this.name.length;
    }

    get wordstr() {
        var tempstr = [];
        for (var i=0; i<this.name.length;i++){
            tempstr.push(this.name.charAt(i));
        }
        return tempstr;
    }
}

// Get random index of the array to pick the word
function getRandomInt(num) {
    return Math.floor(Math.random() * Math.floor(num));
}

// Get index of selected letter for the word e.g. getLetterIndexes('p','apple) return [1,2]
function getLetterIndexes(arr, val) {
    var indexes = [], i = -1;
    while ((i = arr.indexOf(val, i+1)) != -1){
        indexes.push(i);
    }
    return indexes;
}

// Basic to assign basic word pool to word_pool
function basic() {
    levelSelected = true;
    console.log("Before select Basic, the basic word pool is: " + word_basic);
    word_pool = word_basic.slice();
    console.log("After select Basic, the word pool is updated to: " + word_pool);
    document.getElementById("basicBtn").disabled = true;
    document.getElementById("challengeBtn").disabled = true;

}

// challenge to assign challenge word pool to word_pool
function challenge() {
    levelSelected = true;
    word_pool = word_challenge.slice();
    console.log("After select challenge, the word pool is updated to: " + word_pool);
    document.getElementById("challengeBtn").disabled = true;
    document.getElementById("basicBtn").disabled = true;
}

//set gameon to false. 
function stopGame() {
    gameon = false;
    document.getElementById("restartBtn").disabled = false;
}

//enable all the keys after it was disabled during the game
function resetKey() {
    for (var i=0; i <keyActived.length; i++) {
        document.getElementById(keyActived[i]).disabled = false;
    }
    keyActived = [];
}

//display game round number
function gameRoundDisplay() {
    roundDisplay.textContent = gameround;
}

//reset the notes display to null
function noDisplay() {
    resultDisplay.innerHTML = nullHtml;
}

//reset game to play again
function restartGame() {

    console.log("************* restartGame() Start****************")

    // reset the guessed letter and "_" unknown letter to null 
    for (var i=0; i <letterOfWord.length; i++) {
        document.getElementById('letter_' + i).textContent = "";
    }

    //reset all the varabiles 
    letterOfWord = [];
    gameround = 0;
    correctNumLetter = 0;
    word_pool = [];
    wordOfGame = "";
    letternum = 0;
    levelSelected = false;
    currentWordGuess = false;
    imageIndex = 0;
    guessSuccess = 0;
    guessFailed = 0;
    
    gameRoundDisplay();

    //disable the reset button
    document.getElementById("restartBtn").disabled = true;

    //enable the start button 
    document.getElementById("startBtn").disabled = false;

    //enable basic and challenge button
    document.getElementById("basicBtn").disabled = false;
    document.getElementById("challengeBtn").disabled = false;
    document.getElementById("continueBtn").disabled = true;

    //reset the display image to default hangman game image
    currentImg.innerHTML = '<img class = "imgDisplay"  src = "assets/images/hangman.jpg">'; 

    //reset the notes display to null
    noDisplay();

    //reset win or lose number display to 0
    guessSuccessDisplay.textContent = guessSuccess;
    guessFailedDisplay.textContent = guessFailed;

    //activate all the disable key
    console.log("Key Pressed List is: " + keyActived);
    resetKey();

    // Once all the keys are enabled, defaul the keyActive list to null.
    keyActived = [];

    console.log("************* restartGame() End ****************")
}

// start the game, initite all the parameters. 
function startGame() {


    // gameon && word_pool.length >= 1
    console.log("word pool lenght is:" + word_pool.length);
    document.getElementById("restartBtn").disabled = false;
    document.getElementById("continueBtn").disabled = true;
    
    resetKey();

    if (!levelSelected) {
        resultDisplay.innerHTML = notChooseHtml;
        } 
    else if (levelSelected) {
        noDisplay();
        gamerun();
        document.getElementById("startBtn").disabled = true;
    }
}

// initial the game by selecting the word for Play to guess
function gamerun() {

    gameon = true;

    currentImg.innerHTML = '<img class = "imgDisplay" src =" ' + hangmanimglist[imageIndex] +' "  alt="your pick display" />';

    var num = word_pool.length;
    var ramdnum = getRandomInt(num);

    wordOfGame = new word(word_pool[ramdnum]);

    //log current selected word string, need to add the word back to word_pool if guess failed 
    wordOfGameName = wordOfGame.name;
    console.log("Current word to be guessed: " + wordOfGameName);

    letternum = wordOfGame.wordlen;
    console.log("Current word's letter number sum is: " + letternum);

    letterOfWord = wordOfGame.wordstr;
    console.log("Current word's letter array is: " + letterOfWord);

    word_pool.splice(ramdnum,1);
    console.log("After letter selected, the word pool is updated to: " + word_pool);

    for (var i = 0; i < letternum; i++) {
        var dashDisplay = document.getElementById(letterIdList[i]);
        dashDisplay.textContent = "_";
        }
    gameround++;
    gameRoundDisplay();
}

// Once player get the word correctly or incorrectly, continue the game.
function continueGame() {
    console.log("*************ContinueGame() Start****************")
    if (word_pool.length <= 0) {
        resultDisplay.innerHTML = guessCompleteHtml

    } else {
        imageIndex = 0;

        for (var i = 0; i < letternum; i++) {
            var dashDisplay = document.getElementById(letterIdList[i]);
            dashDisplay.textContent = "";
            }

        resetKey();
        gamerun();

        document.getElementById("continueBtn").disabled = true;

        currentWordGuess = false;
        correctNumLetter = 0 ;
    }
    console.log("*************ContinueGame() Ends****************")
}


// once game start, press key to check if it match with letters of word
function btnfunction(clicked_id) {

    console.log("*************btnfunction() Start****************")
    console.log("levelSelected now is : " + levelSelected);
    console.log("gameon now is : " + gameon);
    console.log("currentWordGuess now is : " + currentWordGuess);

    // Check if Basic/Challenge selected. 
    if (!levelSelected) {
        resultDisplay.innerHTML = notChooseHtml_2;
        } 

    // Check if Game start button has been pressed. 
    else if (levelSelected && gameon && !currentWordGuess) {

        console.log("gamone: " + gameon);
        console.log('currentWordGuess: ' + currentWordGuess)

        if (wordOfGame.name.includes(clicked_id)) {

            keyActived.push(clicked_id);
            console.log("Key Pressed List is: " + keyActived);

            var position = [];
            position = getLetterIndexes(wordOfGame.name, clicked_id);
            correctNumLetter = correctNumLetter + position.length;

            console.log("Pressed Keyin word Index:  " + position)
            console.log("Current selected word is: " + letterOfWord);
            console.log("Correct Number Guessed total: ", + correctNumLetter);
            
            // Disable button that has string matches with the string list of word.
            document.getElementById(clicked_id).disabled = true;

            for (var i=0; i<position.length;i++) {
                var letterDisplay = document.getElementById(letterIdList[position[i]]);
                letterDisplay.textContent = letterOfWord[position[i]];
                }
            
            if (correctNumLetter === letternum) {
                guessSuccess++;
                resultDisplay.innerHTML = successNote;
                guessSuccessDisplay.textContent = guessSuccess;
                currentImg.innerHTML = '<img class = "imgDisplay" src =" ' + wordImgList[wordOfGame.name] +' "  alt="your pick display" />';
                currentWordGuess = true;
                wordOfGameName = "";
                document.getElementById("continueBtn").disabled = false;
                }

            } else { 

                keyActived.push(clicked_id);
                console.log("Key Pressed List is: " + keyActived);
                
                document.getElementById(clicked_id).disabled = true;
                imageIndex ++;
                currentImg.innerHTML = '<img class = "imgDisplay" src =" ' + hangmanimglist[imageIndex] +' "  alt="your pick display" />';

                if (imageIndex >=6) {
                    gameon = false;
                    guessFailed++;
                    guessFailedDisplay.textContent = guessFailed;
                    resultDisplay.innerHTML = failHtml;
                    currentWordGuess = false;

                    // add the current word back to current word_pool
                    word_pool.push(wordOfGameName)
                    document.getElementById("continueBtn").disabled = false;
                }

            }
        }
        console.log("*************btnfunction() End****************")
}

    </script>

</body>
</html>